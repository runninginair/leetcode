''' 1962. Remove Stones to Minimize the Total
Medium      640     59      Companies

You are given a 0-indexed integer array piles, where piles[i] represents the
number of stones in the ith pile, and an integer k. You should apply the
following operation exactly k times:

Choose any piles[i] and remove floor(piles[i] / 2) stones from it.
Notice that you can apply the operation on the same pile more than once.

Return the minimum possible total number of stones remaining after applying
the k operations.

floor(x) is the greatest integer that is smaller than or equal to x
(i.e., rounds x down).


Example 1:
Input: piles = [5,4,9], k = 2
Output: 12
Explanation: Steps of a possible scenario are:
- Apply the operation on pile 2. The resulting piles are [5,4,5].
- Apply the operation on pile 0. The resulting piles are [3,4,5].
The total number of stones in [3,4,5] is 12.

Example 2:
Input: piles = [4,3,6,7], k = 3
Output: 12
Explanation: Steps of a possible scenario are:
- Apply the operation on pile 2. The resulting piles are [4,3,3,7].
- Apply the operation on pile 3. The resulting piles are [4,3,3,4].
- Apply the operation on pile 0. The resulting piles are [2,3,3,4].
The total number of stones in [2,3,3,4] is 12.
 

Constraints:    1 <= piles.length <= 10^5
                1 <= piles[i] <= 10^4
                1 <= k <= 105
Accepted:           34.9K
Submissions:        57.1K
Acceptance Rate:    61.0%
'''

import heapq
from typing import List


class Solution:     ### Time Limit Exceeded   T:O(k*n)   42 / 59 testcases passed
    def minStoneSum(self, piles: List[int], k: int) -> int:
        while k:
            heapq._heapify_max(piles)   ### heapify T: O(n)
            mx = heapq.heappop(piles)
            piles.append(mx - (mx >> 1))
            k -= 1
        return sum(piles)

class Solution_v1:     ### Time Limit Exceeded     43 / 59 testcases passed
    def minStoneSum(self, piles: List[int], k: int) -> int:
        while k:
            heapq._heapify_max(piles)
            piles[0] -= piles[0] >> 1
            k -= 1
        return sum(piles)

class Solution_v2:     ### Time Limit Exceeded     43 / 59 testcases passed
    def minStoneSum(self, piles: List[int], k: int) -> int:
        ans = sum(piles)
        for _ in range(k):
            heapq._heapify_max(piles)
            diff = piles[0] >> 1
            ans -= diff
            piles[0] -= diff
            k -= 1
        return ans

class Solution_official:    ### Time complexity: O(n + k*log⁡n)     Space complexity: O(n)
    def minStoneSum(self, piles: List[int], k: int) -> int:
        heap = [-num for num in piles]
        heapq.heapify(heap)
        
        for _ in range(k):
            curr = -heapq.heappop(heap)
            remove = curr // 2
            heapq.heappush(heap, -(curr - remove))
        
        return -sum(heap)    

class Solution_v3:    ### Time complexity: O(n + k*log⁡n)     Space complexity: O(1)
    def minStoneSum(self, piles: List[int], k: int) -> int:
        for i in range(len(piles)): piles[i] = -piles[i]
        heapq.heapify(piles)
        
        for _ in range(k):
            curr = -heapq.heappop(piles)
            remove = curr // 2
            heapq.heappush(piles, -(curr - remove))
        
        return -sum(piles)

class Solution_v4:    ### Time complexity: O(n + k*log⁡n)     Space complexity: O(1)
    def minStoneSum(self, piles: List[int], k: int) -> int:
        for i in range(len(piles)): piles[i] *= -1
        heapq.heapify(piles)        
        for _ in range(k): heapq.heapreplace(piles, piles[0] >> 1)
        return -sum(piles)


def main():
    sol = Solution_v1()
    sol = Solution_v2()
    sol = Solution_v3()
    sol = Solution_v4()

    piles, k = [5,4,9], 2      # Output: 12
    print(sol.minStoneSum(piles, k))

    piles, k = [4,3,6,7], 3    # Output: 12
    print(sol.minStoneSum(piles, k))

    piles = [8937,3317,4105,8140,125,6584,1645,8338,4082,8767,7823,7140,2858,8798,6243,9887,3711,2607,2593,916,183,8381,7169,5095,2626,155,2790,2702,6421,75,8410,9453,9348,1467,2917,4675,1204,1517,4558,7314,7094,8441,935,9184,1397,1186,2997,1341,7396,7307,8409,2077,2776,6329,2567,8014,827,7403,6734,5440,7083,9469,8685,6929,6733,44,8340,5337,7932,4018,7360,6349,2987,6328,3758,6808,8474,2400,4497,4816,8357,2851,7026,2980,8449,2844,203,1973,8268,4246,2348,2917,5369,2399,456,3345,6110,7779,3619,7229,4368,8977,7260,3496,8190,9042,6706,2555,2617,7236,9208,4245,3288,2234,9415,7544,2183,2553,9904,1831,7431,1904,4476,559,4877,7949,3189,9724,5799,1328,7126,2026,2075,2460,1292,2154,5497,7677,2198,7590,7391,5033,5189,8411,9012,7028,6525,197,5199,5560,447,4112,7446,8941,6679,8822,1748,7261,3507,8113,4225,3118,8521,3174,821,6307,3809,6047,2615,6597,8390,3913,8058,2967,9696,1530,1836,1632,8501,462,7663,6881,306,5470,8983,4575,1441,8498,591,2940,4548,6291,9570,650,9469,672,6153,7310,4837,5758,2400,8360,4063,3645,6423,2319,3268,6289,9061,1774,3191,6643,6330,3649,5209,9235,6739,9451,6546,6708,1834,2418,2,7318,690,5917,2126,8310,7395,215,67,9104,8206,7140,6069,7495,7014,3540,5347,8198,3089,6209,4726,7610,7830,8976,8837,9307,6808,4795,9424,7803,3885,4821,1973,1987,3800,7251,829,8217,8379,6769,7166,2081,915,1714,4168,1492,7235,385,4710,3424,6768,3272,66,8003,9377,8434,9037,6432,2156,3055,7072,8912,2656,9434,5611,3321,4532,7803,3977,9858,2547,7048,7086,4853,3827,5619,5940,8874,9931,2439,8817,2758,8952,689,3569,7468,8756,9725,2327,3817,4944,5972,4779,5018,4133,5634,3798,3850,4474,322,6183,2153,4998,5970,4737,96,369,3168,430,602,4000,3566,7704,8647,7206,1942,1033,334,8676,2921,1496,6653,1465,5157,8711,1091,4923,6956,9198,8664,4732,486,7268,3930,5560,6477,7928,1161,2556,2193,621,7255,2081,9288,3825,4169,6204,9557,2290,955,6954,4381,9458,9830,9963,3655,7400,638,7316,7233,8409,8432,6630,2609,5595,2556,5276,7950,4601,7811,2902,9599,9553,864,6727,6261,5291,9586,3822,3907,7154,8964,9695,3173,1237,9761,919,8301,3670,4117,3624,7133,7984,8225,1780,4174,3763,8878,355,9554,2711,9080,5758,1899,1568,6093,1371,2045,8604,3815,7255,4964,5694,7094,8875,8836,9180,3298,7917,9945,796,6308,7063,9478,7426,513,1154,7254,7787,8035,9131,6431,9245,4324,4045,2119,9589,8944,5842,3021,4934,8841,3060,3527,796,2861,9222,8443,8317,391,8808,1367,6089,7873,9370,2217,6881,4892,1815,8012,1574,2166,7794,2059,5599,963,1649,7685,497,5611,65,3980,5339,9413,8793,4169,7115,5717,3876,3737,8901,2598,4988,7879,7033,4984,6525,1120,1122,493,1646,319,6078,7835,954,609,4266,6401,7469,353,6786,2199,3605,5519,2489,7633,7543,5931,3350,3927,8900,8591,1006,8278,5900,2748,8551,9504,9170,557,3543,8674,1682,7735,8200,6676,6281,1577,2928,9281,9799,50,9895,4388,3882,5364,761,1822,101,8188,5138,7424,8863,2727,7170,8973,3765,9054,1690,1591,926,7916,4589,5966,6459,1108,3178,4980,3825,8202,1240,9257,3295,1408,9724,9050,5528,2111,8287,1403,3461,9314,6959,5918,888,9438,8946,9604,7399,6418,2331,6561,1032,2320,4588,3709,5101,6069,6193,9929,2795,77,4229,9132,5907,1846,4098,8155,9370,5503,4628,5341,6970,9254,3270,4219,9139,5542,7631,891,2652,204,6494,2050,7282,3465,3675,4558,595,8470,4543,9820,9673,1468,9423,1963,1929,1873,9350,7358,3821,8407,964,7744,2142,6761,9082,8400,4527,1119,6448,6702,9532,6525,2104,9717,4590,4995,6247,762,3483,198,1870,2240,5345,4824,6372,9225,4500,9390,125,4303,7120,9162,8021,5453,9781,1112,1535,15,6811,8783,7754,3426,813,3962,1569,203,8220,3734,6843,1972,5518,3252,2830,9011,730,7398,3546,5956,9318,1092,7991,7557,7678,5967,6226,423,1861,3482,9587,7247,9128,9729,4140,6079,7600,8799,8491,741,1977,4915,972,8521,7594,3564,7651,3872,8252,7151,7987,1146,5930,29,4170,3044,5040,6032,1379,6600,645,6206,9438,4067,485,5973,8177,241,1411,3775,6481,368,8506,8770,6407,6044,612,7590,2950,3690,7530,9465,6693,2171,7500,1303,5521,2580,990,4494,4319,7727,10,5164,5328,943,7807,173,8192,9921,9470,5176,2093,6001,7643,4338,4981,4778,3356,6900,8024,9070,3497,5725,751,8134,1955,8946,3363,3067,5946,1506,3230,9857,261,1150,3476,852,7075,7630,5088,3763,8860,1500,5004,3585,1736,3205,3570,7965,2995,703,8433,8216,8403,9555,3867,4886,2756,3014,8128,9053,414,7101,9105,3620,3532,96,9528,4051,3874,1205,4577,4826,7767,4512,8342,7673,9030,2986,8483,1286,7695,7047,4456,7832,1456,1588,7109,3109,5676,2537,6546,2525,7821,9786,1855,5044,855,7769,1815,3735,3075,2835,3688,2367,2571,4396,7687,9640,2078,1137,6344,3056,8925,8551,6819,4647,8643,9289,7160,2825,9951,2908,3384,4031,5936,2487,4911,6044,4608,7468,5185,2746,903,2998,5132,4763,2045,1102,6997,9582,6445,5673,1905,6626,9083,2083,4962,1183,6560,4599,9177,285,1743,3870,5077,7994,8136,9541,205,9364,2514,853,8127,7666,656,2721,3413,7272,4518,5154,7256,1896,3349,7402,6688,5398,9784,7706,6808,2346,2352,7754,6251,790,5518,5899,3429,613,9031,5194,4831,8491,3808,3593,5191,1120,2116,7034,6149,1513,3138,7980,7443,1586,2416,5236,2339,1692,2012,183,1061,6644,6297,554,3212,7560,4195,9194,9379,5561,5624,9906,6008,5959,8046,9828,9259,3590,290,2944,5877,3932,7025,2860,9084,6231,2424,1900,311,7587,6384,1765,1964,42,7486,1853,6815,7943,287,880,4113,8181,5528,8453,5841,8774,6726,3911,3775,8904,8464,879,4667,4341,863,7370,2616,914,9935,4000,7412,9267,3795,991,1515,2761,7508,3481,1652,9398,4689,3224,2552,3716,3536,1383,9198,1484,97,4896,7856,4051,1718,7443,202,4611,2244,108,8311,3632,6558,7962,3572,8822,292,7564,4283,7192,8025,4119,8197,166,6759,6938,8645,1985,2718,4938,1536,152,402,253,9211,5207,932,9964,3690,306,8901,7707,9303,8102,1934,5795,264,7626,2654,7327,3551,769,8415,689,5899,8305,7301,9627,7322,5785,8790,4349,5356,9355,9262,6690,1736,7666,9196,4072,8403,9104,6244,8599,89,1479,2694,1496,3234,3345,5206,104,7020,2354,1956,7260,2999,8658,3025,2096,3847,6052,2851,4835,476,8151,1987,944,2206,6129,4413,4730,5855,217,8975,2668,4031,8138,3933,4955,9099,1760,7932,2221,9419,2746,4741,2884,2829,2884,6150,8050,7518,2176,8776,2967,1256,9638,5510,806,4801,9080,8093,7111,4355,8802,6064,3852,3478,2208,5796,1007,7918,8943,3846,5331,5211,4701,242,8479,4654,334,9294,6852,7434,952,6044,701,8400,7502,3267,1911,1254,9579,4475,1992,2179,8516,4346,5853,5093,4082,2798,5779,216,9238,6693,7097,5914,4088,9574,9350,9835,3392,7671,7709,7586,634,9539,2500,7483,4141,2363,3505,5464,6003,3988,6724,1112,8171,3115,1133,7977,4201,4867,6710,2678,4982,6041,6229,7579,6141,2994,9945,8814,885,6334,238,9435,5339,3378,474,9923,5080,4465,9776,757,2757,2772,8928,4996,1995,506,1493,2626,5765,8396,9610,8848,3013,1160,8128,2922,7149,6743,1401,9364,1714,9124,473,2984,5955,872,7626,5194,2744,3268,6317,5568,7133,4486,6602,4079,233,5064,934,2349,3570,1626,2771,430,6378,4631,6257,9594,3593,6324,7671,5286,9858,2456,7888,7679,4592,8711,8864,7032,8218,8564,4010,622,1592,4299,3078,1886,9023,1460,6214,2592,5367,7683,6601,8403,7091,7595,458,9312,1187,1825,3930,1923,674,2013,3533,4772,5381,4378,4882,4832,871,5324,3458,4593,1593,9253,4991,5868,6285,8603,8767,9467,2967,2351,5715,7918,9172,5192,8135,6983,263,1951,5960,882,3630,5326,1771,4820,3737,9018,800,6504,5909,2433,8239,8264,6879,485,2756,2805,4653,1010,9574,8911,8043,9423,3305,7752,4589,4699,1888,8933,1248,7581,6806,6522,9774,7973,8162,3287,9818,3935,7134,5766,1897,1320,7702,6992,5034,1247,6641,8958,1835,4145,5758,193,8945,7928,1516,8080,2097,9032,9018,3284,9064,8493,8331,1413,8248,9271,9647,6688,1909,9478,4748,6249,6911,7471,1666,6168,1827,3282,5402,474,5337,431,6410,1180,4534,5933,3438,9727,1135,3781,613,9593,5043,7000,3641,2262,8849,3510,4106,9190,7765,7080,4063,4376,2285,1350,168,3861,2285,7695,2456,4778,6782,6374,9451,9628,4883,8952,8863,1660,7092,8049,1588,4459,2266,5178,6215,167,8274,4265,1625,2870,9618,3270,7057,2920,6596,575,6997,5623,3913,6096,1284,9010,2459,6174,1937,5207,6304,1876,4691,2985,2921,1090,9166,6703,6767,8951,4178,7218,5134,1815,6402,5946,405,118,7118,589,2260,2441,8988,1621,2837,1527,5604,7646,8196,8014,8804,7043,9456,6313,3618,324,3685,882,5440,4171,8389,3343,147,315,2401,4305,7694,2454,1208,6982,3516,152,4712,934,7863,1645,2979,9912,8282,2013,6125,2809,3275,3219,2759,9166,6115,5241,407,8141,385,8416,3925,2828,2366,4503,8184,3557,9580,5501,9184,4140,2819,6396,3166,1740,9724,9667,8019,4481,4600,7813,8487,474,156,6812,5566,1097,1761,5429,4881,2475,4574,2139,634,6737,9812,8006,9868,6996,5957,1505,3562,215,6248,7684,7758,8267,6062,8066,2928,10000,2117,2882,2854,8892,6520,3157,4538,5397,210,8753,6974,3339,722,3022,6074,5738,3356,343,5493,3148,1618,6874,3470,894,988,2058,9787,1988,6816,7693,9885,9752,836,6077,438,1799,8876,134,7238,333,4417,6025,8531,9867,3396]
    k = 9309                   # Output: 158061
    print(sol.minStoneSum(piles, k))

    piles = [4002,2548,3015,1664,9847,912,8017,8629,2080,5167,2257,830,4202,525,5940,2286,5876,8015,710,7638,541,2858,2717,4146,3878,5494,5375,5009,424,6175,1587,555,1370,5970,6462,2813,4844,2278,3403,3321,6220,2709,1760,8790,6574,1307,5660,3051,221,2230,5219,5961,7917,9144,3554,5142,9975,4766,6407,6945,9791,2703,1502,5831,7463,3427,1513,872,4515,9295,8625,6509,8170,6529,5566,4930,9983,1626,3608,1844,5035,6107,3385,19,4623,9549,4210,6882,7343,5131,4050,4099,3467,3511,4369,9011,5237,2730,8415,2763,6919,3257,3023,5512,49,568,682,3165,4880,8877,4700,199,4143,683,3653,2682,6874,7934,885,3416,7650,6170,230,9949,6603,4961,7223,6493,6514,2466,8261,8228,6340,1467,9395,754,9747,2782,5266,6458,9348,8307,2548,9685,8391,6705,1391,4302,6060,332,8650,2670,1445,3443,85,9879,2338,3853,7502,1862,5825,3679,1585,6091,4305,1094,2495,5108,1386,6681,7118,1682,6393,6505,8379,9684,2431,994,1935,6421,2533,1894,9717,4190,8415,8548,5835,2956,4236,5848,8506,7245,8131,2511,7135,5815,7680,9774,2177,6508,8106,4934,5281,8314,7215,4950,1457,4915,5927,2945,9071,8006,5616,6650,8410,3043,3349,9448,4720,5579,3270,6118,7039,1191,7619,6921,3926,3776,6149,1090,1326,4859,6793,3253,9550,1845,8983,1901,3891,6216,2388,5722,4292,2087,6813,660,771,1756,7897,6846,2625,303,3210,2589,7324,9719,5293,8966,2401,9542,6530,7447,5778,8779,5406,1161,2545,2673,5818,8588,4780,4997,3871,8437,821,89,9707,6820,3728,9157,5140,9853,1511,1634,7717,9704,6596,2631,9453,5451,3300,1367,469,3709,5083,6509,6792,5803,1307,5247,5319,4516,4159,5408,1254,3441,4799,5347,56,4789,4595,3008,1451,4472,9918,4232,1067,3276,998,3449,6646,3295,3469,9499,3057,3890,536,818,6992,2874,5384,9955,597,3100,8551,879,9669,4142,7944,7219,9341,8340,6664,6458,4782,3721,9739,117,563,8809,1426,6173,9025,3934,5657,6610,1549,8458,2172,170,3874,2231,6597,619,6619,4850,2330,9810,1798,6925,2586,9003,8409,77,7015,3029,9549,9056,2259,4954,8836,4632,6919,2725,3416,6051,8417,1168,574,9797,3150,4922,8543,755,1768,4104,5598,8288,7066,1196,2086,3489,1652,8418,806,6957,6696,4618,6114,6191,6833,3320,9780,8354,4595,7226,2494,6486,8750,3350,2554,5291,60,1100,8675,9759,4079,4071,5875,1200,6738,2504,559,8510,8952,8994,9974,6878,1289,2526,2134,9707,2367,1657,6307,884,9941,8084,2034,4363,2327,6695,2560,704,2444,9792,7452,5615,8743,6517,559,9563,2435,8751,8777,581,4807,3884,5284,2910,4996,2720,6542,6959,2419,2466,6555,7009,5800,4125,7075,4917,7886,7359,623,4051,3046,1576,184,5369,3214,1169,6440,7578,2120,3532,2219,5770,254,6261,4479,5157,277,7911,6337,6415,3516,1448,6797,5877,5367,3629,1942,1111,7076,4801,4439,5037,1889,6181,5891,54,4163,7604,8789,9330,6943,6624,4371,9337,2823,8171,6656,4668,8921,1361,4372,554,1351,110,4911,9621,4568,6603,5875,5575,4024,8289,8362,4142,7968,6923,4433,6086,8800,5745,4836,674,9068,7338,1640,5885,8473,3557,3885,1877,2879,6324,5758,6881,31,2515,4566,8677,8777,4674,2793,1382,8038,2035,9266,7982,4750,5609,9532,3293,7937,3844,3004,1912,1987,859,9529,1865,792,6544,3834,7188,3164,9370,8371,4556,6887,947,2400,6072,6309,2364,9667,9214,4508,2223,699,6688,5181,4670,5394,5192,6464,3883,734,2139,2034,2988,6216,5554,4961,9980,556,6742,2522,941,764,7083,5424,335,4677,4681,9155,9453,9453,6938,1518,8839,6974,8176,4974,8604,737,5299,4773,6385,9922,1100,3053,1838,18,3450,9229,5832,1590,5273,4640,6914,7833,9438,6777,5452,2899,2076,8245,5295,4307,3201,4780,3938,6617,5094,6339,5827,7567,8606,1687,9356,7343,2333,7531,3484,8163,1755,6933,9453,3314,8067,2873,5664,7008,9667,795,6855,6897,9844,9052,8420,7049,990,9123,2485,6952,355,8775,978,6778,1955,5597,3059,31,7474,4085,1473,7385,3922,8780,9883,6282,5233,314,1439,5126,9942,5658,3082,1967,4075,7780,4470,9918,6512,1034,8701,5225,6773,7171,2774,3815,8148,3998,9237,3523,4608,9135,407,9483,7556,5079,5914,3074,7602,7266,6525,510,329,9287,6227,6888,5197,8095,2629,8142,9289,8219,6193,1359,8137,4900,5822,5043,4493,9423,5355,7118,7285,6609,4462,4707,2513,9202,939,5871,9231,9153,9485,8613,4788,8055,6384,6500,5612,9369,9045,7953,7864,6602,3824,6007,1731,5077,7485,783,5763,2378,2089,6995,8976,4824,8938,2769,7976,1631,703,8263,9676,6579,6775,8793,4740,5712,5531,3056,7126,8643,8302,2006,5734,7610,3758,955,1886,7158,8571,7771,2931,3922,6278,3722,3796,9267,2135,9457,148,5926,6662,694,8792,834,7725,5062,8701,3666,36,7500,2012,2000,5921,7577,5083,7020,4178,3639,3744,3473,1045,9228,4980,4902,5922,5278,2556,9570,662,5440,2752,8508,8661,9795,4482,4154,6227,3858,8705,455,4453,8599,9768,7053,435,2084,9548,6373,6920,1493,2716,1845,139,2182,5278,9060,2675,6287,9171,8986,738,5371,1923,7933,1663,1403,8990,5412,6893,1223,6724,5345,3969,9118,7688,3330,7016,2786,1157,7946,3214,291,4854,5429,9919,573,5161,9982,852,3928,773,4227,7445,6489,4702,4493,5768,9738,9415,1356,1618,7271,6047,2994,7075,9945,7617,3372,5663,4659,3899,8363,3271,1400,8681,2604,8014,7571,9841,9557,9198,6572,3563,141,2540,2858,3182,5692,4093,4473,2584,3880,6401,5764,6710,2222,1054,7953,913,7285,9444,591,4873,2553,6241,6242,1785,111,5480,6789,5574,9080,1110,3788,6306,7418,2192,9786,6228,9506,1198,3122,6765,6311,4324,7776,2976,4760,8420,8402,6317,3029,8890,6232,2044,8167,241,1441,8838,4923,2876,8093,3469,3864,7177,9500,2442,962,6437,1598,311,2513,8288,6670,6328,2961,2072,8730,531,2348,4045,4135,2943,5868,7846,5903,2218,2650,4420,6900,7202,2901,9527,2686,9089,2022,3219,3812,1080,5465,2880,3145,2165,2556,8924,2664,8086,1383,981,3193,5154,2971,6131,4647,3050,9681,4329,2011,9941,1670,6478,168,2610,1116,8865,3309,1134,5367,7889,6859,4317,7979,280,4099,6184,6774,8621,426,2067,6842,189,7997,9526,3018,333,5159,2485,8476,9365,1417,5461,6509,2982,1345,1246,6769,3200,6016,1100,6911,5344,2950,4548,6258,2514,376,4590,9197,480,1221,5931,1534,115,9302,3438,4780,4856,514,8485,9540,7607,9653,7898,6976,5630,3361,5917,3241,6956,1281,7058,31,3215,4620,2131,1630,119,1146,8108,1533,9428,7711,92,3263,1509,1360,6770,4975,1420,9708,170,4593,6137,5812,6620,3406,5767,9233,8261,3939,5288,5953,9583,130,6107,9025,8963,4255,9329,9992,4350,7491,3107,5881,6064,7965,2999,1210,279,615,656,4331,9111,1004,35,9436,1859,8398,6655,6622,6282,2674,2008,4405,9632,605,3578,117,9967,4410,2726,7449,1636,7948,6287,310,6828,8026,6088,6264,6423,3298,2103,5168,621,5125,2567,9072,2986,2187,6713,8459,741,9391,350,9716,8268,7324,9075,5666,2343,4279,7808,4385,4568,888,5834,7634,4350,5260,5190,1014,5054,8207,2642,3187,6456,496,3813,6150,8720,2920,9054,9063,1960,8154,2025,5193,96,2556,6690,6667,7324,1888,4521,8118,8104,594,874,6608,1117,827,6959,1971,9177,767,4913,2126,8435,6480,7918,123,7676,2418,8221,3097,9314,9880,5257,4245,4513,2003,8548,7304,4166,5947,1601,4227,1228,4550,2501,8571,3405,8872,2891,1526,1365,1733,1321,8405,4582,5264,5257,7135,3976,9559,5212,5827,1932,2315,2867,5435,7324,31,8890,2430,1514,3729,7857,518,2042,632,8920,5960,9879,2153,7887,6121,5783,2305,633,8866,1375,7826,5422,4478,1943,1564,8308,2276,7777,3505,8676,5628,7653,440,1448,5761,5751,175,5682,9556,9796,9521,7134,8828,2813,7833,1742,709,7045,7922,3921,7297,9411,9891,4750,2117,3617,1785,3036,6527,3437,9742,5973,7421,7973,5016,7057,2834,8890,3718,751,1030,3257,2527,9316,9723,2226,8690,5470,1865,5683,5464,7560,9982,5084,8508,8171,4841,3617,9452,641,9129,9143,913,5995,8112,5821,3211,1593,5001,8285,1855,2204,3662,7373,9047,4970,2933,1433,9625,7165,8077,4572,5499,3270,8974,707,6932,8452,4496,2985,4034,5388,4974,9074,968,7949,6714,7987,3362,9581,4094,950,9547,6124,5956,6039,5022,5390,255,3384,5457,3014,7416,6141,458,5788,4030,9313,1993,7406,2639,2028,2376,1193,7366,7168,3185,5457,1883,1218,6594,9467,7595,3100,6500,1793,2201,6930,4412,4410,5791,1577,3454,2275,8067,2080,2583,5731,5408,346,9405,8417,4471,3257,4447,2095,6767,6830,8318,9411,6778,2415,8723,2989,1692,3882,7275,5626,1344,8032,742,2837,9516,1074,9400,5142,5944,7972,5679,1922,2451,5335,6581,3737,5409,725,417,3925,3322,6504,2548,2144,5429,1691,1375,5096,4806,6907,6605,2803,5198,7451,8397,159,1184,2402,1423,6802,3515,6230,8375,6218,7704,3150,6980,1525,1724,4220,8344,2822,4216,1947,5710,2182,4311,7663,1275,4806,8090,8035,632,639,4366,7881,6966,2081,6759,3921,3842,4306,2438,587,1740,809,5673,642,6258,1136,3396,9120,6151,7330,7338,2647,4071,1796,5934,4710,6216,4426,8668,5872,5087,8533,6016,6312,9665,3888,6970,8266,4904,3673,3478,8918,7170,9913,7134,9582,2150,1995,5227,7309,1717,5787,4230,4107,6732,5721,9090,6150,8469,6638,379,9906,7327,2724,5990,5465,4042,4788,2908,3657,8404,4885,4262,3796,580,1949,1659,7412,6231,9272,929,2379,4790,5975,3977,8137,9209,6102,6461,1780,9682,6378,2383,3712,1524,6717,1765,8833,1521,7416,8526,9317,4302,1531,7984,7958,9043,3737,7036,9579,2730,7915,9056,7254,4565,9530,1029,2575,9994,801,150,346,8980,7558,929,4851,5249,9186,6453,1415,8657,6211,9146,3786,8794,8899,4420,10,6228,8064,5893,3534,9860,2055,8917,5440,760,6219,3883,818,1418,9606,1445,8679,6738,9215,7748,9278,6505,3646,3288,4264,6872,9605,976,3976,4817,2883,597,7644,9554,5057,3097,239,4206,91,3661,8295,2165,4619,1350,232,4649,4711,8492,4822,9900,1793,2765,3180,1676,226,519,3111,9834,8520,8019,3191,3303,7880,6636,969,9894,8728,2543,4085,2210,4063,917,3583,4058,1615,1264,6016,466,2041,5065,5993,1732,9519,4095,8347,7273,7166,2602,2887,6285,8044,4493,5429,908,710,2624,7525,2714,5358,76,4663,7769,2127,4973,6920,6115,56,541,4086,2159,5730,8805,3591,3672,760,4399,1167,8261,2895,9091,748,5224,4561,712,7852,2575,3454,4758,9485,6159,3429,7031,201,3845,392,7876,8927,507,4300,9327,1842,7761,8967,8323,2840,6005,7310,7186,3967,6412,3648,2904,2891,6097,4160,5515,7540,4753,651,6540,51,613,4451,9082,1953,2213,9072,9697,2460,6754,2153,5938,7390,8936,6379,1277,1557,1935,7552,7379,8287,9433,715,8826,2476,6134,6219,9254,1920,6196,722,9256,5379,4790,5481,3144,5950,279,7070,8321,6246,848,5955,3668,6939,7837,2025,7661,8576,5242,4504,5679,5100,4040,2805,3334,7119,6156,715,5358,4880,2462,4626,9525,5617,9643,1239,9382,7666,2586,8875,2014,7934,602,4206,556,5625,2956,4001,6293,2230,2439,3319,1108,7042,3250,6557,5491,7824,4714,2808,1589,2373,9528,7004,7490,8573,4723,7900,1692,438,2802,1234,1632,9983,2757,6542,4937,1237,2680,4392,4763,1175,5333,5161,7673,1094,1024,2100,9482,1488,5088,8282,1049,8266,8075,5883,7470,8135,7607,796,397,454,6236,7984,6557,3992,8193,8004,9083,9542,1831,9874,1447,4807,5021,6951,4435,2379,8876,6754,6520,8077,1432,3381,3554,6984,1912,8595,8101,2793,9220,4122,6004,9566,8550,232,314,9957,6546,353,9038,7534,9831,6397,7703,8935,1472,2914,1274,47,1574,9480,2602,2688,5378,8729,8160,4123,8659,8780,5774,7916,5992,6567,9882,4376,1274,4584,6501,6364,2428,9815,3284,368,55,4357,2632,4322,4618,9824,5937,2140,9849,3764,9162,3999,9714,3901,380,8300,8739,5076,4729,8146,3884,7497,3744,8161,3758,5112,6575,4629,3604,727,6822,1459,9924,7050,7791,6074,6665,3302,1031,8470,4023,1524,3429,4690,9385,4101,4638,9837,4155,9830,3146,5773,8792,4923,1458,7803,4739,1864,2004,4092,6978,8237,4846,5087,4449,9207,1701,6050,4601,4986,3733,2549,5609,1498,5383,9000,5853,2447,2195,7207,8898,3145,3801,5577,3605,7599,7920,1983,2325,1646,5814,872,580,6804,7539,2648,7698,7109,9679,7203,331,9163,297,2763,2603,1402,8695,1045,8560,8847,8592,32,5074,5973,5858,5794,1145,7323,2238,1103,7650,6689,1007,8395,8426,662,4616,3662,6569,2747,5438,7694,4194,2649,4953,180,6036,6482,816,2009,8155,4898,1621,9612,5676,5302,76,5111,6276,3587,3817,7459,9338,9761,888,9271,814,3875,1831,7614,1276,5145,1635,1849,8650,5340,1285,3623,406,8283,1208,4947,1403,7687,1262,6432,6567,6092,1956,2404,4573,282,5718,1251,6607,6847,1058,1365,6640,292,9205,4162,4732,3726,4243,3004,7650,5866,6672,4100,3421,6509,4590,8836,3242,6597,7980,8749,9103,3736,9125,6325,3547,4487,3015,3646,667,2807,7874,2947,2875,2976,9495,7629,8648,6726,6490,8946,3258,6060,9654,4619,9742,8011,3758,388,3420,7875,1726,8600,4118,2364,3912,8141,2018,145,9633,5075,5151,632,7427,8728,7938,8239,8815,1271,7166,7341,8818,6509,7100,6901,8969,1933,9409,1220,2427,2780,377,8359,2134,5962,4988,8152,317,4992,9788,8608,4072,9626,2838,7280,17,7914,1792,467,1061,8811,7967,7342,418,8839,4790,5845,1675,1585,1361,9050,2603,3572,6165,23,4747,5131,9128,6220,7219,6273,8481,2925,2104,6624,8238,7189,3766,7250,1424,7701,5520,9848,4089,1967,9020,7534,3942,4810,8759,6067,3774,1644,1904,5323,7371,4216,1245,804,5688,826,4531,9198,4050,6640,2681,4757,6729,8561,1580,8269,5073,3447,2127,1162,1147,9552,374,383,4914,6165,3615,2086,1528,4782,3296,787,630,9987,8791,7887,116,8072,1559,9899,8771,6113,5306,1417,2881,7457,3791,2529,4199,252,4564,9053,4688,6986,3711,286,9732,3777,7420,7769,9544,3461,4962,2323,660,2267,7673,6396,9285,6669,859,4318,4790,8524,1044,9486,5952,6972,4562,379,4049,589,5324,328,4731,4095,5774,7867,3948,2266,3632,4959,9056,3570,6354,152,8465,1680,8526,5989,4249,5464,8059,1608,2983]
    k = 9771                    # Output: 687461
    print(sol.minStoneSum(piles, k))

if __name__ == "__main__":
    main()
